varf vibroAcousticsNewton([incux,incuy,incp],[deltaux,deltauy,deltap])=
int2d(Ths)(
    (E/(2.0*(1.0+nu)))
    *(
        (dx(incux)*dx(deltaux) + dy(incuy)*dy(deltauy))
      + 0.5*(dy(incux)+dx(incuy))*(dy(deltaux)+dx(deltauy))
     )
  + (E*nu/((1.0+nu)*(1.0-2.0*nu)))
    *( (dx(incux)+dy(incuy))*(dx(deltaux)+dy(deltauy)) )
  - (omega^2)*rhos*(incux*deltaux + incuy*deltauy)
)
+ int1d(Ths,5)(
    incp*(deltaux*N.x + deltauy*N.y)
)
+ int2d(Thf)(
    (dx(incp)*dx(deltap) + dy(incp)*dy(deltap))
  - (omega^2)*(rhof/Kf)*incp*deltap
)
+ int1d(Ths,5)(
    -rhof*(incux*N.x + incuy*N.y)*deltap
)
+ on(3,incux=0.0)
+ on(3,incuy=0.0)
+ on(2,incp=0.0)
+ on(4,incp=0.0)
;