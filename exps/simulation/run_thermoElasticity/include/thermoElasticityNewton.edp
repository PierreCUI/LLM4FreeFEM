varf thermoElasticityNewton([incux,incuy,incT],[deltaux,deltauy,deltaT]) =
  int2d(Th)(
      (E/(2.0*(1.0+nu))) * ( dx(incux)*dx(deltaux) + dy(incuy)*dy(deltauy)
                           + 2.0*(0.5*(dy(incux)+dx(incuy)))*(0.5*(dy(deltaux)+dx(deltauy))) )
    + (E*nu/((1.0+nu)*(1.0-2.0*nu))) * ( (dx(incux)+dy(incuy))*(dx(deltaux)+dy(deltauy)) )
    - (E/(1.0-2.0*nu))*alpha * incT * (dx(deltaux)+dy(deltauy))
    + k*( dx(incT)*dx(deltaT) + dy(incT)*dy(deltaT) )
  )
  + on(2,incux=0.0)
  + on(4,incux=0.0)
  + on(2,incuy=0.0)
  + on(4,incuy=0.0)
  + on(2,incT=0.0)
  + on(4,incT=0.0)
;